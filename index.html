<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" href="JourneyLogo.png" type="image/svg+xml">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Journey Pro — Roadmap (Full-bleed)</title>
<meta name="description" content="Black & white, smooth roadmap to become a hire-ready full-stack Swift developer by 18. Side-scrollable, full-bleed Roadmap with glass-fill progress." />
<style>
  :root{
    --bg:#0a0a0a; --panel:#111; --panel-2:#161616; --text:#f5f5f5; --muted:#bdbdbd; --line:#262626;
    --accent:#ffffff; --radius:16px; --shadow:0 1px 0 rgba(255,255,255,0.04) inset, 0 10px 25px rgba(0,0,0,0.6);
    --speed:280ms; --ease:cubic-bezier(.2,.7,.2,1);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font:14px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Inter,"SF Pro",Arial,sans-serif;
    color:var(--text);
    background:
      radial-gradient(1000px 600px at 15% -10%, #111 0%, #0a0a0a 60%, #212529 100%),
      linear-gradient(#0a0a0a,#000);
    background-attachment:fixed;
    letter-spacing:.1px;
  }

  /* default content width for list views */
  .wrap{max-width:1100px;margin:0 auto;padding:28px 18px 80px}

  /* full-bleed when viewing the Roadmap */
  body.fullbleed .wrap{max-width:100vw;padding-left:0;padding-right:0}
  body.fullbleed .panel{border-left:none;border-right:none;border-radius:0}
  body.fullbleed .cards{padding-left:0;padding-right:0}

  header.app{
    position:sticky;top:0;z-index:10;
    backdrop-filter:saturate(140%) blur(12px);
    background:linear-gradient(180deg, rgba(10,10,10,.85), rgba(10,10,10,.55) 60%, rgba(10,10,10,0));
    border-bottom:1px solid var(--line);
  }
  header.app .inner{max-width:1100px;margin:0 auto;padding:18px}
  .brand{display:flex;align-items:center;gap:14px;user-select:none;animation:fadeIn .8s var(--ease) both}
  .logo {
    width: 34px;
    height: 34px;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 0 0 1px var(--line) inset, 0 12px 30px rgba(0,0,0,.6);
    display: flex;
    align-items: center;
    justify-content: center;
    background: none; /* remove gradient */
  }

  .logo img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: block;
  }
  .title{font-weight:650;font-size:18px;letter-spacing:.3px}
  .subtitle{color:var(--muted);font-size:12px}

  .toolbar{margin-top:14px;display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .progress{flex:1 1 320px;display:flex;align-items:center;gap:12px}
  .bar{position:relative;height:10px;border-radius:999px;overflow:hidden;background:linear-gradient(180deg,#0f0f0f,#0b0b0b);
       box-shadow:var(--shadow),0 0 0 1px var(--line) inset;flex:1}
  .bar .fill{height:100%;width:0%;background:linear-gradient(180deg,#fff,#bdbdbd);box-shadow:0 8px 24px rgba(255,255,255,.08);
             transform-origin:left center;transition:width var(--speed) var(--ease),transform var(--speed) var(--ease)}
  .percent{min-width:64px;text-align:right;color:#eaeaea;font-variant-numeric:tabular-nums}
  .btn{appearance:none;border:1px solid var(--line);background:linear-gradient(180deg,#111,#0b0b0b);color:var(--text);
       padding:10px 14px;border-radius:12px;box-shadow:var(--shadow);cursor:pointer;
       transition:transform var(--speed) var(--ease),border-color var(--speed) var(--ease),background var(--speed) var(--ease)}
  .btn:hover{transform:translateY(-1px)} .btn:active{transform:translateY(0)} .btn.ghost{background:transparent}
  .spacer{flex:1}

  .tabs{margin:18px 0 8px;display:flex;gap:8px;flex-wrap:wrap}
  .tab{padding:10px 12px;border-radius:999px;border:1px solid var(--line);
       background:linear-gradient(180deg,#121212,#0d0d0d);color:var(--muted);cursor:pointer;
       transition:all var(--speed) var(--ease);user-select:none}
  .tab.active{color:#000;background:linear-gradient(180deg,#fff,#cfcfcf);
              box-shadow:0 8px 24px rgba(255,255,255,.12),0 0 0 1px rgba(255,255,255,.3) inset}

  .panel{border:1px solid var(--line);background:linear-gradient(180deg,#0f0f0f,#0b0b0b);border-radius:var(--radius);
         box-shadow:var(--shadow);overflow:hidden;animation:rise .7s var(--ease) both}
  .grid{display:grid;gap:12px;grid-template-columns:repeat(12,1fr)}
  .cards{padding:14px}
  .card{grid-column:span 12;border:1px solid var(--line);background:linear-gradient(180deg,#111,#0d0d0d);border-radius:14px;padding:14px;
        display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:center;
        transition:border-color var(--speed) var(--ease),transform var(--speed) var(--ease),background var(--speed) var(--ease);position:relative}
  .card:hover{transform:translateY(-1px);border-color:#2d2d2d}
  .check{width:22px;height:22px;border-radius:6px;display:grid;place-items:center;border:1px solid var(--line);background:#0e0e0e;cursor:pointer;
         transition:all var(--speed) var(--ease)}
  .check[data-checked="true"]{background:linear-gradient(180deg,#fff,#dcdcdc);color:#000;border-color:#cfcfcf;box-shadow:0 6px 16px rgba(255,255,255,.12)}
  .meta{display:flex;flex-direction:column;gap:2px} .label{font-weight:600} .sub{color:var(--muted);font-size:12px}
  .pill{border:1px solid var(--line);padding:6px 10px;border-radius:999px;color:#e8e8e8;background:linear-gradient(180deg,#121212,#0c0c0c);font-size:12px;cursor:pointer}
  .more{grid-column:1/-1;border-top:1px dashed #1f1f1f;margin-top:12px;padding-top:12px;display:none;color:#ddd}
  .links{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
  .link{border:1px solid var(--line);background:linear-gradient(180deg,#121212,#0c0c0c);color:#fff;text-decoration:none;
        padding:8px 10px;border-radius:10px;font-size:12px;transition:transform var(--speed) var(--ease),border-color var(--speed) var(--ease)}
  .link:hover{transform:translateY(-1px);border-color:#2b2b2b}

  .searchbar{display:flex;gap:10px;align-items:center;padding:12px;border-bottom:1px solid var(--line);
             background:linear-gradient(180deg,#0f0f0f,#0b0b0b)}
  .input{flex:1;border:1px solid var(--line);background:#0d0d0d;color:#fff;border-radius:12px;padding:10px 12px;outline:none;
         transition:border-color var(--speed) var(--ease),background var(--speed) var(--ease)}
  .input:focus{border-color:#2a2a2a;background:#101010}
  .filterTag{border:1px solid var(--line);padding:8px 10px;border-radius:12px;font-size:12px;background:#0d0d0d}

  footer{margin-top:22px;color:var(--muted);font-size:12px;text-align:center;animation:fadeIn .9s var(--ease) both}

  @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
  @keyframes rise{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}
  .slideIn{animation:fadeIn .45s var(--ease) both}
  .pulse{animation:pulse 1200ms var(--ease) 1}
  @keyframes pulse{0%{transform:scaleX(1)}40%{transform:scaleX(1.02)}100%{transform:scaleX(1)}}
  @media (min-width:720px){.card{grid-template-columns:auto 1fr auto}}
  @media (min-width:860px){.card{grid-template-columns:auto 1fr auto}}

  /* ===== Roadmap (full-bleed, side-scroll) ===== */
  .roadwrap{
    width:100vw;
    overflow-x:auto; overflow-y:hidden;
    -webkit-overflow-scrolling:touch;
    scroll-snap-type:x mandatory;
    cursor:grab; user-select:none;
    padding:6px 0 24px;
    border-bottom:1px solid var(--line);
    overscroll-behavior-x:contain;
  }
  .roadwrap.dragging{cursor:grabbing}
  .roadtrack{display:flex;gap:64px;padding:24px min(4vw,40px)}
  /* BIG clusters: use almost full viewport width */
  .cluster{
    position:relative;
    flex:0 0 clamp(980px, 92vw, 1600px);
    min-width:clamp(980px, 92vw, 1600px);
    scroll-snap-align:center;
    display:grid; grid-template-columns:1fr 1fr; grid-template-rows:auto 280px; align-items:start; justify-items:center;
    border:1px solid var(--line); border-radius:16px;
    background:linear-gradient(180deg,#111,#0d0d0d);
    box-shadow:var(--shadow);
  }
  .hub{grid-column:1 / span 2; padding-top:24px}
  .node{display:flex; flex-direction:column; align-items:center; gap:10px}
  .hubLabel{font-weight:700;font-size:16px}
  .nodeLabel{font-weight:600}
  .nodeSub{color:#eaeaea;font-size:12px}
  .glass{
    width:160px;height:160px;margin:0 auto 8px;border-radius:32px;position:relative;overflow:hidden;border:2px solid #fff;
    background:linear-gradient(180deg,#101010,#0a0a0a);box-shadow:inset 0 0 0 2px rgba(255,255,255,.05),0 10px 22px rgba(0,0,0,.6)
  }
  .glass.small{width:128px;height:128px;border-radius:28px}
  .glass .fill{position:absolute;left:0;right:0;bottom:0;height:0%;background:linear-gradient(180deg,#fff,#dcdcdc);transition:height 420ms var(--ease)}
  .glass svg{position:absolute;inset:0;width:100%;height:100%;stroke:#fff;fill:none;stroke-width:2.2;pointer-events:none}

  .wires{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none}
  .wirepath{stroke:#fff;stroke-width:2.2;fill:none;stroke-linecap:round;opacity:.85}
</style>
</head>
<body>
<header class="app">
  <div class="inner">
    <div class="brand">
        <div class="logo">
          <img src="JourneyLogo.png" alt="Journey Logo">
        </div>
      <div>
        <div class="title">Journey Pro</div>
        <div class="subtitle">Black-and-white roadmap to a hire-ready full-stack Swift role</div>
      </div>
    </div>

    <div class="toolbar">
      <div class="progress" aria-live="polite">
        <div class="bar" aria-label="Overall progress"><div class="fill" id="progressFill"></div></div>
        <div class="percent" id="progressPercent">0%</div>
      </div>
      <button class="btn ghost" id="expandAllBtn" title="Expand all details">Expand all</button>
      <button class="btn" id="resetBtn" title="Reset progress (local)">Reset</button>
      <span class="spacer"></span>
    </div>

    <div class="tabs" role="tablist" aria-label="Years">
      <div class="tab active" role="tab" aria-selected="true" tabindex="0" data-view="16">Year 16</div>
      <div class="tab" role="tab" aria-selected="false" tabindex="0" data-view="17">Year 17</div>
      <div class="tab" role="tab" aria-selected="false" tabindex="0" data-view="18">Year 18</div>
      <div class="tab" role="tab" aria-selected="false" tabindex="0" data-view="all">All</div>
      <div class="tab" role="tab" aria-selected="false" tabindex="0" data-view="roadmap">Roadmap</div>
    </div>
  </div>
</header>

<main class="wrap">
  <section class="panel">
    <div class="searchbar" id="searchRow">
      <input class="input" id="search" placeholder="Search tasks, courses, tools…" />
      <button class="btn" id="clearSearch">Clear</button>
      <span id="groupPill" class="filterTag" style="display:none;"></span>
    </div>
    <div class="cards grid" id="cards"></div>
  </section>

  <footer>
    <div>“Consistency beats talent when talent isn’t consistent.”</div>
    <div id="saveStatus" aria-live="polite" style="margin-top:6px;">Saved locally</div>
  </footer>
</main>

<script>
/* ---------------- Tasks (same curated set as before) ---------------- */
const ROADMAP = [
  {id:"y16-swiftui-100days",year:16,title:"Swift & SwiftUI — 100 Days",category:"SwiftUI",
    details:"Project-based SwiftUI training.",links:[{label:"100 Days of SwiftUI",url:"https://www.hackingwithswift.com/100/swiftui"}],
    tools:["Xcode"],notes:"Ship every mini-app."},
  {id:"y16-apple-swiftui-tuts",year:16,title:"Apple SwiftUI Tutorials",category:"SwiftUI",
    details:"Official SwiftUI walkthroughs.",links:[{label:"SwiftUI Tutorials",url:"https://developer.apple.com/tutorials/swiftui"}],
    tools:["Xcode"],notes:"Focus on state/data flow."},
  {id:"y16-cs50",year:16,title:"Computer Science Basics (CS50)",category:"CS Fundamentals",
    details:"Algorithms, memory, problem solving.",links:[{label:"Harvard CS50",url:"https://cs50.harvard.edu/x/"}],
    tools:["C","Python"],notes:"Explain solutions clearly."},
  {id:"y16-leetcode-easy-40",year:16,title:"LeetCode: 40 Easy problems",category:"Interview Prep",
    details:"Arrays/strings/hash maps.",links:[{label:"LeetCode Easy",url:"https://leetcode.com/problemset/all/?difficulty=EASY"}],
    tools:["LeetCode"],notes:"3–5 weekly."},
  {id:"y16-uikit-basics",year:16,title:"UIKit basics alongside SwiftUI",category:"iOS",
    details:"VCs, nav stack, interop.",links:[{label:"UIKit",url:"https://developer.apple.com/documentation/uikit/"}],
    tools:["UIKit"],notes:"Legacy codebases."},
  {id:"y16-concurrency",year:16,title:"Swift Concurrency (async/await, actors)",category:"Swift",
    details:"Structured concurrency.",links:[{label:"Concurrency",url:"https://developer.apple.com/documentation/swift/concurrency"}],
    tools:["Task","Actor"],notes:"Modern Swift."},
  {id:"y16-networking",year:16,title:"Networking: URLSession + Codable + errors",category:"Networking",
    details:"REST, retry/backoff, UX errors.",links:[{label:"URLSession",url:"https://developer.apple.com/documentation/foundation/urlsession"}],
    tools:["Postman"],notes:"Resilience."},
  {id:"y16-coredata",year:16,title:"Persistence: Core Data fundamentals",category:"Storage",
    details:"Models, fetch, contexts.",links:[{label:"Core Data",url:"https://developer.apple.com/documentation/coredata"}],
    tools:["NSPersistentContainer"],notes:"Offline-first."},
  {id:"y16-hig",year:16,title:"Human Interface Guidelines (HIG)",category:"Design",
    details:"Layout, motion, hierarchy.",links:[{label:"HIG",url:"https://developer.apple.com/design/human-interface-guidelines/"}],
    tools:["Spacing","Typography"],notes:"Native feel."},
  {id:"y16-accessibility",year:16,title:"Accessibility & Dynamic Type",category:"UX",
    details:"VoiceOver, labels, contrast.",links:[{label:"Accessibility",url:"https://developer.apple.com/accessibility/"}],
    tools:["VoiceOver"],notes:"Craft."},
  {id:"y16-animations",year:16,title:"Micro-interactions & animations",category:"Polish",
    details:"MatchedGeometry, springs.",links:[{label:"Animating Views",url:"https://developer.apple.com/tutorials/swiftui/animating-views-and-transitions"}],
    tools:["withAnimation"],notes:"Subtle motion."},
  {id:"y16-git-pro",year:16,title:"Git Pro: branching, PRs, Conventional Commits",category:"Craft",
    details:"Readable history, reviews.",links:[{label:"Git Book",url:"https://git-scm.com/book/en/v2"}],
    tools:["GitHub"],notes:"Team-ready."},
  {id:"y16-firebase-core",year:16,title:"Firebase: Auth + Firestore + Storage",category:"Backend",
    details:"BaaS with rules & cache.",links:[{label:"Firebase iOS",url:"https://firebase.google.com/docs/ios/setup"}],
    tools:["Firestore","Auth"],notes:"Ship CRUD app."},
  {id:"y16-crashlytics",year:16,title:"Crashlytics & Analytics (basic)",category:"Quality",
    details:"Track crashes & events.",links:[{label:"Crashlytics",url:"https://firebase.google.com/docs/crashlytics"}],
    tools:["Firebase"],notes:"Crash-free sessions."},
  {id:"y16-instruments",year:16,title:"Instruments: Time Profiler & Leaks",category:"Performance",
    details:"Fix slow paths, cycles.",links:[{label:"Instruments",url:"https://developer.apple.com/documentation/xcode/improving-your-apps-performance"}],
    tools:["Profiler","Leaks"],notes:"Measure first."},
  {id:"y16-portfolio",year:16,title:"Monochrome portfolio site",category:"Portfolio",
    details:"One-page projects + links.",links:[{label:"GitHub Pages",url:"https://pages.github.com/"}],
    tools:["HTML/CSS"],notes:"Lighthouse 95+."},
  {id:"y16-sideproj-social",year:16,title:"Side Project: Simple social feed",category:"Project",
    details:"Auth, posts, likes, pagination.",links:[{label:"Firestore data model",url:"https://firebase.google.com/docs/firestore/data-model"}],
    tools:["Auth","Firestore"],notes:"Moderation basics."},

  /* Year 17 */
  {id:"y17-appstore",year:17,title:"Ship an App Store app",category:"Shipping",
    details:"TestFlight → release; privacy.",links:[{label:"App Store Connect",url:"https://developer.apple.com/support/app-store/"}],
    tools:["Organizer"],notes:"Proof you deliver."},
  {id:"y17-node-express",year:17,title:"Node.js + Express + MongoDB API",category:"Backend",
    details:"JWT, CRUD, rate limits.",links:[{label:"Express",url:"https://expressjs.com/"}],
    tools:["Postman","MongoDB"],notes:"Deploy hosted."},
  {id:"y17-vapor",year:17,title:"Vapor (Swift server) alternative",category:"Backend",
    details:"Routes, JWT, Fluent.",links:[{label:"Vapor Docs",url:"https://docs.vapor.codes/"}],
    tools:["SwiftNIO"],notes:"Pure Swift."},
  {id:"y17-testing",year:17,title:"Unit & UI Tests (XCTest/XCUITest)",category:"Quality",
    details:"Model + happy-path UI tests.",links:[{label:"XCTest",url:"https://developer.apple.com/documentation/xctest"}],
    tools:["XCTest"],notes:"Refactor safely."},
  {id:"y17-ci-actions",year:17,title:"CI: GitHub Actions for iOS",category:"DevOps",
    details:"Build/test on PR; lint.",links:[{label:"GitHub Actions",url:"https://docs.github.com/actions"}],
    tools:["CI"],notes:"Basic pipeline."},
  {id:"y17-open-source",year:17,title:"Open Source: one PR/month",category:"Community",
    details:"Docs/tests/fixes.",links:[{label:"Alamofire",url:"https://github.com/Alamofire/Alamofire"}],
    tools:["PRs"],notes:"Code in open."},
  {id:"y17-wwdc-ssc",year:17,title:"WWDC Swift Student Challenge",category:"Apple",
    details:"Interactive Playgrounds.",links:[{label:"SSC",url:"https://developer.apple.com/wwdc24/swift-student-challenge/"}],
    tools:["Playgrounds"],notes:"Apple cred."},
  {id:"y17-interview-75",year:17,title:"LeetCode: Top 75 (E/M)",category:"Interview Prep",
    details:"Interview patterns.",links:[{label:"Top 75",url:"https://leetcode.com/problem-list/top-75/"}],
    tools:["LeetCode"],notes:"Daily habit."},
  {id:"y17-notifications",year:17,title:"Push Notifications (APNs/FCM)",category:"iOS APIs",
    details:"Token, topics, deep links.",links:[{label:"UNUserNotificationCenter",url:"https://developer.apple.com/documentation/usernotifications/"}],
    tools:["APNs","FCM"],notes:"Respect control."},
  {id:"y17-inapp",year:17,title:"In-App Purchases (StoreKit 2)",category:"Monetization",
    details:"Entitlements, restore.",links:[{label:"StoreKit 2",url:"https://developer.apple.com/documentation/storekit"}],
    tools:["StoreKit"],notes:"Product sense."},
  {id:"y17-localization",year:17,title:"Localization (EN + ES)",category:"Quality",
    details:"String catalogs, RTL.",links:[{label:"Localization",url:"https://developer.apple.com/localization/"}],
    tools:["String Catalogs"],notes:"Broader reach."},
  {id:"y17-logging-analytics",year:17,title:"Observability: logs & analytics",category:"Quality",
    details:"Structured logs & events.",links:[{label:"OSLog",url:"https://developer.apple.com/documentation/os/logging"}],
    tools:["os_log"],notes:"Debug prod fast."},
  {id:"y17-freelance",year:17,title:"Freelance/Client project",category:"Experience",
    details:"Stakeholder, deadlines.",links:[{label:"Upwork",url:"https://www.upwork.com/"}],
    tools:["Contracts"],notes:"Real impact."},

  /* Year 18 */
  {id:"y18-flagship",year:18,title:"Flagship App (SwiftUI + Backend)",category:"Capstone",
    details:"Offline-first, error-proof, animated.",links:[{label:"Architecture overview",url:"https://developer.apple.com/documentation/"}],
    tools:["SwiftUI","Backend"],notes:"Ownership."},
  {id:"y18-career-referrals",year:18,title:"Referral outreach (20 messages)",category:"Career",
    details:"Short notes + portfolio link.",links:[{label:"LinkedIn",url:"https://www.linkedin.com/"}],
    tools:["Templates"],notes:"2–5× interview chance."},
  {id:"y18-resume",year:18,title:"Resume: impact bullets + links",category:"Career",
    details:"Action verb + what + impact.",links:[{label:"Resume tips",url:"https://www.sequoiacap.com/article/writing-a-resume-that-works/"}],
    tools:["PDF"],notes:"One page."},
  {id:"y18-apply",year:18,title:"Apply broadly (Apple/Meta/Amazon + startups)",category:"Career",
    details:"Tailor to JD/stack.",links:[{label:"Apple Jobs",url:"https://jobs.apple.com/"},
           {label:"Meta Careers",url:"https://www.metacareers.com/"},
           {label:"Amazon Jobs",url:"https://www.amazon.jobs/"}],
    tools:["Tracker"],notes:"20–50 apps."},
  {id:"y18-onsite",year:18,title:"Onsite/Loop prep (iOS + DSA + behavioral)",category:"Interview Prep",
    details:"Whiteboard & product sense.",links:[{label:"HIG review",url:"https://developer.apple.com/design/human-interface-guidelines/"}],
    tools:["Mock loops"],notes:"Record & review."},
  {id:"y18-ci-cd",year:18,title:"Release quality: tests + CI + rollout",category:"DevOps",
    details:"Snapshots/UI tests; CI.",links:[{label:"GitHub Actions",url:"https://docs.github.com/actions"}],
    tools:["XCTest","CI"],notes:"Safer releases."},
  {id:"y18-privacy-policy",year:18,title:"Privacy policy & terms (basic)",category:"Compliance",
    details:"Plain-English docs.",links:[{label:"Sample policy",url:"https://www.termsfeed.com/blog/sample-privacy-policy-template/"}],
    tools:["Links in app"],notes:"App Review friendly."},
  {id:"y18-postmortem",year:18,title:"Postmortem habit (blameless)",category:"Craft",
    details:"Root cause, lessons.",links:[{label:"SRE postmortems",url:"https://sre.google/sre-book/postmortem-culture/"}],
    tools:["Template"],notes:"Maturity signal."}
];

/* --------- Skill groups (for Roadmap glasses) --------- */
const GROUPS = {
  swiftui:{label:"SwiftUI",cats:["SwiftUI","iOS","Swift","Networking","Storage","iOS APIs","Design","UX","Polish"]},
  backend:{label:"Backend",cats:["Backend"]},
  design:{label:"Design/UX",cats:["Design","UX","Polish"]},
  cs:{label:"Algorithms/CS",cats:["CS Fundamentals","Interview Prep","Architecture"]},
  devops:{label:"DevOps/Testing",cats:["DevOps","Quality","Performance","Compliance","Craft"]},
  career:{label:"Career/Brand",cats:["Career","Portfolio","Community","Experience","Apple"]},
  projects:{label:"Projects",cats:["Project","Shipping","Capstone"]}
};
const GROUP_CHILDREN = {
  swiftui:["UI / State","Animations"],
  backend:["Firebase","Node/Vapor"],
  design:["HIG / A11y","Micro-polish"],
  cs:["DSA","System Design"],
  devops:["Testing","CI / Release"],
  career:["Resume","Referrals"],
  projects:["App Store","Flagship"]
};

/* Icons */
function iconSVG(name){
  switch(name){
    case 'swiftui': return `<svg viewBox="0 0 100 100"><rect x="22" y="22" rx="10" ry="10" width="56" height="40"/><rect x="30" y="68" rx="6" ry="6" width="40" height="10"/></svg>`;
    case 'backend': return `<svg viewBox="0 0 100 100"><rect x="18" y="22" width="64" height="16" rx="6"/><rect x="18" y="42" width="64" height="16" rx="6"/><rect x="18" y="62" width="64" height="16" rx="6"/></svg>`;
    case 'design':  return `<svg viewBox="0 0 100 100"><path d="M22 68l22-22 16 16-22 22H22z"/><path d="M64 30l6-6c4-4 10-4 14 0s4 10 0 14l-6 6-14-14z"/></svg>`;
    case 'cs':      return `<svg viewBox="0 0 100 100"><circle cx="20" cy="50" r="8"/><circle cx="50" cy="24" r="8"/><circle cx="80" cy="50" r="8"/><circle cx="50" cy="76" r="8"/><path d="M28 50l14-20M58 30l14 20M28 50l14 20M72 50l-14 20"/></svg>`;
    case 'devops':  return `<svg viewBox="0 0 100 100"><circle cx="36" cy="50" r="16"/><circle cx="64" cy="50" r="16"/><path d="M20 50h-6M86 50h-6M36 34V20M64 34V20M36 66v14M64 66v14"/></svg>`;
    case 'career':  return `<svg viewBox="0 0 100 100"><rect x="18" y="36" width="64" height="36" rx="8"/><path d="M38 36v-8c0-4 3-6 6-6h12c3 0 6 2 6 6v8"/></svg>`;
    case 'projects':return `<svg viewBox="0 0 100 100"><path d="M50 78V46"/><path d="M50 22l16 16-16 8-16-8 16-16z"/><path d="M34 70h32"/></svg>`;
    default: return `<svg/>`;
  }
}

/* ---------- State & helpers ---------- */
const els = {
  cards: document.getElementById('cards'),
  tabs: Array.from(document.querySelectorAll('.tab')),
  fill: document.getElementById('progressFill'),
  percent: document.getElementById('progressPercent'),
  search: document.getElementById('search'),
  clearSearch: document.getElementById('clearSearch'),
  expandAll: document.getElementById('expandAllBtn'),
  reset: document.getElementById('resetBtn'),
  saveStatus: document.getElementById('saveStatus'),
  searchRow: document.getElementById('searchRow'),
  groupPill: document.getElementById('groupPill')
};
const KEY = "journey.pro.roadmap.progress.v1";
let state = loadState();
let activeView = "16";         // "16" | "17" | "18" | "all" | "roadmap"
let expandAll = false;
let query = "";
let groupFilter = null;

function loadState(){ try{ return JSON.parse(localStorage.getItem(KEY)||"{}"); }catch(e){ return {}; } }
function saveState(){ localStorage.setItem(KEY, JSON.stringify(state)); flashSaved(); }
function flashSaved(){ els.saveStatus.textContent = "Saved locally"; els.saveStatus.classList.remove('slideIn'); void els.saveStatus.offsetWidth; els.saveStatus.classList.add('slideIn'); }

/* Category → Group mapping */
const CAT_TO_GROUP = {};
Object.entries(GROUPS).forEach(([gid,def])=> def.cats.forEach(c => CAT_TO_GROUP[c.toLowerCase()] = gid));
function groupForCategory(cat){ return CAT_TO_GROUP[(cat||"").toLowerCase()] || 'swiftui'; }

/* Progress computation */
function computeProgress(ids=null){
  const used = ids ?? ROADMAP.map(t=>t.id);
  const done = used.filter(id => state[id] === true).length;
  const pct  = used.length ? Math.round((done / used.length) * 100) : 0;
  els.fill.style.width = pct + "%";
  els.fill.classList.add('pulse'); setTimeout(()=>els.fill.classList.remove('pulse'),400);
  els.percent.textContent = pct + "%";
}

/* Filters */
function matchesQuery(task,q){
  if(!q) return true;
  const hay = (task.title+" "+task.category+" "+(task.details||"")+" "+(task.tools||[]).join(" ")+" "+(task.notes||"")).toLowerCase();
  return hay.includes(q.toLowerCase());
}
function inGroup(task){ if(!groupFilter) return true; return groupForCategory(task.category) === groupFilter; }
function visibleTasks(){
  return ROADMAP.filter(t =>
    ((activeView==="all")?true:(activeView==="roadmap"?false:(t.year+""===activeView))) &&
    inGroup(t) && matchesQuery(t,query)
  );
}

/* ---------- Rendering ---------- */
function render(){
  // toggle full-bleed when in Roadmap view
  document.body.classList.toggle('fullbleed', activeView === "roadmap");

  if(activeView === "roadmap") renderRoadmap(); else renderTaskList();
  if(activeView === "roadmap") computeProgress(null); else computeProgress(visibleTasks().map(t=>t.id));
  els.groupPill.style.display = groupFilter ? "inline-block" : "none";
  els.groupPill.textContent = groupFilter ? `Filter: ${GROUPS[groupFilter].label}` : "";
}

function renderTaskList(){
  const tasks = visibleTasks();
  els.cards.innerHTML = ""; els.searchRow.style.display = "flex";
  const frag = document.createDocumentFragment();
  tasks.forEach(task=>{
    const card = document.createElement('div'); card.className = "card"; card.dataset.id = task.id;

    const check = document.createElement('button'); check.className = "check"; check.setAttribute("aria-label","Mark complete");
    check.dataset.checked = !!state[task.id]; check.innerHTML = state[task.id] ? "✓" : "";
    check.addEventListener('click', ()=>{ const now = !state[task.id]; state[task.id]=now; check.dataset.checked = now; check.innerHTML = now ? "✓" : ""; saveState(); computeProgress(visibleTasks().map(t=>t.id)); });

    const meta = document.createElement('div'); meta.className = "meta";
    const label = document.createElement('div'); label.className = "label"; label.textContent = task.title;
    const sub = document.createElement('div'); sub.className = "sub"; sub.textContent = `${task.category} • Year ${task.year}`;
    meta.appendChild(label); meta.appendChild(sub);

    const pill = document.createElement('div'); pill.className = "pill"; pill.textContent = "Details";
    const more = document.createElement('div'); more.className = "more";
    more.innerHTML = `
      <div style="color:#e9e9e9">${task.details||""}</div>
      ${task.tools?.length?`<div style="margin-top:8px;color:#cfcfcf;font-size:12px">Tools/Programs: ${task.tools.join(", ")}</div>`:""}
      ${task.notes?`<div style="margin-top:8px;color:#cfcfcf;font-size:12px">Notes: ${task.notes}</div>`:""}
      ${task.links?.length?`<div class="links">${task.links.map(l=>`<a class="link" href="${l.url}" target="_blank" rel="noopener noreferrer">${l.label}</a>`).join("")}</div>`:""}
    `;
    pill.addEventListener('click',()=>{ more.style.display = (more.style.display==="block") ? "none" : "block"; });

    card.appendChild(check); card.appendChild(meta); card.appendChild(pill); card.appendChild(more);
    frag.appendChild(card);
  });
  els.cards.appendChild(frag);
}

/* ---- Roadmap (full-bleed side-scroll clusters) ---- */
function renderRoadmap(){
  els.cards.innerHTML = ""; els.searchRow.style.display = "none";

  const wrap = document.createElement('div'); wrap.className = "roadwrap";
  const track = document.createElement('div'); track.className = "roadtrack"; wrap.appendChild(track);

  Object.entries(GROUPS).forEach(([gid,def])=>{
    // tasks for group
    const ids = ROADMAP.filter(t => groupForCategory(t.category)===gid).map(t=>t.id);
    const done = ids.filter(id => state[id]).length;
    const pct = ids.length ? Math.round((done/ids.length)*100) : 0;

    const cluster = document.createElement('div'); cluster.className = "cluster slideIn";

    // hub
    const hub = document.createElement('div'); hub.className = "hub";
    const hubGlass = document.createElement('div'); hubGlass.className = "glass";
    const hubFill = document.createElement('div'); hubFill.className = "fill"; requestAnimationFrame(()=>hubFill.style.height = pct+"%");
    hubGlass.appendChild(hubFill);
    const hubIconWrap = document.createElement('div'); hubIconWrap.innerHTML = iconSVG(gid); hubGlass.appendChild(hubIconWrap.firstChild);
    const hubLabel = document.createElement('div'); hubLabel.className = "hubLabel"; hubLabel.textContent = def.label;
    const hubPct = document.createElement('div'); hubPct.className = "nodeSub"; hubPct.textContent = pct+"%";
    hub.appendChild(hubGlass); hub.appendChild(hubLabel); hub.appendChild(hubPct);
    hub.style.textAlign = "center";
    hub.style.cursor = "pointer";
    hub.title = "Show tasks for " + def.label;
    hub.addEventListener('click', ()=>{ groupFilter = gid; setActiveTab("all"); render(); });

    // children
    const [leftText,rightText] = GROUP_CHILDREN[gid];
    const left = nodeEl(gid,leftText,true);
    const right = nodeEl(gid,rightText,false);

    // wires (svg)
    const wires = document.createElementNS("http://www.w3.org/2000/svg","svg");
    wires.classList.add("wires");
    cluster.appendChild(wires);

    // place in grid
    cluster.appendChild(hub);
    cluster.appendChild(left);
    cluster.appendChild(right);
    track.appendChild(cluster);

    // after paint, draw curves
    requestAnimationFrame(()=> drawClusterWires(cluster, wires, hubGlass, left.querySelector('.glass'), right.querySelector('.glass')));
  });

  enableDragScroll(wrap);
  els.cards.appendChild(wrap);
}

/* child node element */
function nodeEl(gid,label,isLeft){
  const n = document.createElement('div'); n.className = "node"; n.style.marginTop = "8px";
  const g = document.createElement('div'); g.className = "glass small";
  const iconWrap = document.createElement('div'); iconWrap.innerHTML = iconSVG(gid); g.appendChild(iconWrap.firstChild);
  const t = document.createElement('div'); t.className = "nodeLabel"; t.textContent = label;
  n.appendChild(g); n.appendChild(t);
  n.title = "Show tasks for " + GROUPS[gid].label; n.style.cursor="pointer";
  n.addEventListener('click', ()=>{ groupFilter = gid; setActiveTab("all"); render(); });
  return n;
}

/* draw Bezier wires */
function drawClusterWires(cluster, svg, hubGlass, leftGlass, rightGlass){
  const rect = cluster.getBoundingClientRect();
  const hub = hubGlass.getBoundingClientRect();
  const left = leftGlass.getBoundingClientRect();
  const right = rightGlass.getBoundingClientRect();
  const toLocal = r => ({ cx:(r.left+r.width/2)-rect.left, top:r.top-rect.top, bottom:(r.top+r.height)-rect.top });

  const H = toLocal(hub), L = toLocal(left), R = toLocal(right);
  const width = rect.width, height = rect.height;
  svg.setAttribute("viewBox", `0 0 ${width} ${height}`);
  svg.setAttribute("width", width); svg.setAttribute("height", height);

  const pathL = `M ${H.cx} ${H.bottom-10} C ${H.cx} ${H.bottom+120}, ${L.cx} ${L.top-120}, ${L.cx} ${L.top+6}`;
  const pathR = `M ${H.cx} ${H.bottom-10} C ${H.cx} ${H.bottom+120}, ${R.cx} ${R.top-120}, ${R.cx} ${R.top+6}`;

  svg.innerHTML = `<path class="wirepath" d="${pathL}"/><path class="wirepath" d="${pathR}"/>`;
}

/* drag-to-scroll */
function enableDragScroll(wrap){
  let isDown=false,startX,scrollLeft;
  wrap.addEventListener('mousedown',(e)=>{isDown=true;wrap.classList.add('dragging');startX=e.pageX-wrap.offsetLeft;scrollLeft=wrap.scrollLeft;});
  wrap.addEventListener('mouseleave',()=>{isDown=false;wrap.classList.remove('dragging');});
  wrap.addEventListener('mouseup',()=>{isDown=false;wrap.classList.remove('dragging');});
  wrap.addEventListener('mousemove',(e)=>{if(!isDown) return; e.preventDefault(); const x=e.pageX-wrap.offsetLeft; const walk=(x-startX)*1.2; wrap.scrollLeft=scrollLeft-walk;});
  wrap.addEventListener('wheel', (e)=>{ if(Math.abs(e.deltaY)>Math.abs(e.deltaX)) { wrap.scrollLeft += e.deltaY; e.preventDefault(); } }, {passive:false});
}

/* ---------- Events ---------- */
function setActiveTab(name){
  activeView = name;
  els.tabs.forEach(t=>{ const on = t.dataset.view===name; t.classList.toggle('active', on); t.setAttribute('aria-selected', on?"true":"false"); });
}

els.tabs.forEach(tab=>{
  tab.addEventListener('click', ()=>{ setActiveTab(tab.dataset.view); render(); });
  tab.addEventListener('keydown', e=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); tab.click(); } });
});
els.search.addEventListener('input', ()=>{ query = els.search.value.trim(); render(); });
els.clearSearch.addEventListener('click', ()=>{ els.search.value=""; query=""; groupFilter=null; render(); });
els.groupPill.addEventListener('click', ()=>{ groupFilter=null; render(); });
els.expandAll.addEventListener('click', ()=>{
  expandAll=!expandAll; els.expandAll.textContent = expandAll ? "Collapse all" : "Expand all";
  if(activeView!=="roadmap"){ document.querySelectorAll('.more').forEach(el=> el.style.display = expandAll?"block":"none"); }
});
els.reset.addEventListener('click', ()=>{
  if(confirm("Reset all local progress?")){ state={}; saveState(); render(); }
});

/* Initial render */
render();

/* Redraw wires on resize */
window.addEventListener('resize', ()=>{
  if(activeView!=="roadmap") return;
  document.querySelectorAll('.cluster').forEach(cluster=>{
    const svg = cluster.querySelector('.wires');
    const hub = cluster.querySelector('.hub .glass');
    const [left,right] = cluster.querySelectorAll('.node .glass');
    drawClusterWires(cluster, svg, hub, left, right);
  });
});

/* Respect reduced motion */
if(window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches){
  document.documentElement.style.setProperty('--speed','0ms');
}
</script>
</body>
</html>
